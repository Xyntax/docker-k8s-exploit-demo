#!/usr/bin/env bash
echo '[apt]-----'
apt update && apt install -y libcap2-bin curl wget vim

echo '[kernel]-----'
uname -a

echo '[$PATH]-----'
echo $PATH

echo '[container env]-----'
cat /proc/self/cgroup | grep "/docker/" | sed -n 1p
cat /proc/self/cgroup | grep "/kube" | sed -n 1p

echo '[docker.sock]-----'
find / -name docker.sock 2>/dev/null | grep "docker.sock"

echo '[kubectl config]-----'
find / -name .kube 2>/dev/null | grep "kube"

echo '[k8s service account]-----'
find / -name serviceaccount 2>/dev/null | grep serviceaccount

echo '[/mnt]-----'
ls /mnt*

echo '[find mount]-----'
find / -name mount 2>/dev/null | grep mount

echo '[custom user]-----'
cat /etc/passwd | grep -nE "100[0-9]"

echo '[check capability]-----'
capsh --print | grep ptrace

echo '[check disk]-----'
fdisk -l | grep "dev/vd"

echo '[check proc namespace]-----'
ps -ef | grep sshd
ps -ef | grep watchdog
ps -ef | grep netns